<div class="buttons">
  <button class="button buy-button" (click)="openAddModal()">Nowa pozycja</button>
</div>
<table class="portfolio-table">
  <thead>
  <tr>
    <th>Symbol</th>
    <th>Wolumen</th>
    <th>Średnia cena zakupu</th>
    <th>Wartość zakupu</th>
  </tr>
  </thead>
  <tbody>
    @for (position of positions; track position.id) {
      <tr class="position-row"
          (dblclick)="onRowDoubleClick(position)">
        <td data-label="Symbol">
          <span>{{ position.symbol }}  </span>
        </td>
        <td data-label="Wolumen">
          <span>{{ position.quantity }}</span>
        </td>
        <td data-label="Średnia cena zakupu">
          <span>{{ position.averagePrice | number:'1.2-2' }} <small>{{ position.currency }}</small>
          </span>
        </td>
        <td data-label="Wartość zakupu">
          <span>{{ position.averagePrice * position.quantity  | number:'1.2-2' }}
            <small>{{ position.currency }}</small>
          </span>
        </td>
        <td>
          @if (selectedForEdit() === position) {
            <button class="edit-btn" (click)="editPosition(position)">
              <fa-icon [icon]="faEdit"></fa-icon>
            </button>
            <button class="edit-btn" (click)="editPosition(position)">
              <fa-icon [icon]="faPlus"></fa-icon>
            </button>
            <button class="edit-btn" (click)="editPosition(position)">
              <fa-icon [icon]="faMinus"></fa-icon>
            </button>
          }
        </td>
      </tr>
    }
  </tbody>
</table>

@if (isAddModalOpen()) {
  <app-add-position-modal
    (cancel)="closeAddModal()"
    (positionSubmit)="addPosition($event)">
  </app-add-position-modal>
}

@if (isEditModalOpen() && selectedForEdit()) {
  <app-edit-position-modal
    [position]="selectedForEdit()!"
    (cancel)="closeEditModal()"
    (positionEdit)="editPosition($event)">
  </app-edit-position-modal>
}
